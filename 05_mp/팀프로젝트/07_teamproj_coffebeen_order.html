<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë©”ë‰´ | ìˆ˜ì œì»¤í”¼ë¸Œë£¨</title>
    <style>
        body {
            margin: 0;
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #fdfcf7;
            color: #333;
        }
        header {
            background-color: #2d4739;
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        nav a {
            color: white;
            margin: 0 15px;
            text-decoration: none;
        }
        nav a.active {
            font-weight: bold;
            text-decoration: underline;
        }
        .container {
            max-width: 1200px;
            margin: 40px auto;
            padding: 0 20px;
        }
        h2.section-title {
            color: #2d4739;
            text-align: center;
            margin-bottom: 40px;
        }
        .menu-grid, .menu-grid2 {
            display: grid;
	
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        .menu-card, .menu-card2 {
            background-color: #fff;
	border:1px solid #2d4739;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 20px;
            text-align: center;
        }
        .menu-card img, .menu-card2 img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
        }
        .menu-card h3, .menu-card2 h3 {
            margin: 10px 0;
            color: #2d4739;
        }
        .menu-card p, .menu-card2 p {
            margin: 5px 0;
            color: #e67e22;
            font-weight: bold;
        }
         .menu-card:hover,
        .menu-card2:hover {
            transform: translateY(-5px);
        }
        .btn {
            background-color: #2d4739;
            color: #fdfcf7;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
        }
        .btn:hover {
            background-color: #1f3128;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background-color: #fdfcf7;
            padding: 15px;
            border-radius: 10px;
            max-width: 400px;
            width: 85%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 4px 16px rgba(0,0,0,0.2);
        }
        .modal-content h3 {
            margin: 0 0 10px;
            color: #2d4739;
            font-size: 1.2em;
        }
        .form-group {
            margin-bottom: 10px;
        }
        .form-group label {
            display: block;
            margin-bottom: 4px;
            font-size: 0.9em;
            font-weight: bold;
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
            font-size: 0.9em;
        }
        .form-group .error {
            color: #e67e22;
            font-size: 0.8em;
            display: none;
        }
        .options-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        .options-group label {
            display: inline;
            margin-right: 5px;
        }
        .options-group input[type="radio"], .options-group input[type="checkbox"] {
            width: auto;
            vertical-align: middle;
        }
        .inline-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .cart-item {
            border-bottom: 1px solid #eee;
            padding: 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .cart-item-details {
            flex: 1;
        }
        .cart-item-actions {
            display: flex;
            gap: 5px;
        }
        .total-section {
            margin: 10px 0;
            font-size: 0.9em;
        }
        .btn-group {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        footer {
            background-color: #2d4739;
            color: white;
            padding: 20px;
            text-align: center;
            margin-top: 40px;
        }
        @media (max-width: 768px) {
            .modal-content {
                max-width: 320px;
            }
            .options-group, .inline-group {
                grid-template-columns: 1fr;
            }
            .menu-grid, .menu-grid2 {
                grid-template-columns: 1fr;
            }
            .cart-item {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>ìˆ˜ì œì»¤í”¼ë¸Œë£¨</h1>
        <nav>            
            <a href="./07_teamproj_index.html">í™ˆ</a>
            <a href="./07_teamproj_submenu.html">ë©”ë‰´</a>
            <a href="./07_teamproj_menu_order.html" class="active">ì£¼ë¬¸í•˜ê¸°</a>
            <a href="./07_teamproj_findstore.html">ë§¤ì¥ ì°¾ê¸°</a>
            <a href="./07_teamproj_order_page.html">ë°°ì†¡í˜„í™©</a>
            <a href="./07_teamproj_order_tracking.html" >ì£¼ë¬¸ì¡°íšŒ</a>
            <a href="./07_teamproj_login.html">ë¡œê·¸ì¸</a>
            <a href="./07_teamproj_join_page.html">íšŒì› ê°€ì…</a>
            <a href="./07_teamproj_board.html">ììœ  ê²Œì‹œíŒ</a>
            <span class="cart-icon">ì¥ë°”êµ¬ë‹ˆğŸ›’<span class="cart-count">0</span></span>
        </nav>
    </header>

    <div class="container">
        <h2 class="section-title">ìš°ë¦¬ì˜ ì¸ê¸° ì»¤í”¼ ë©”ë‰´</h2>
        <div class="menu-grid">
            <div class="menu-card">
                <img src="./02_CSS/img/bg_tree.png" alt="ë¸Œë£¨ë“œ ì•„ë©”ë¦¬ì¹´ë…¸">
                <h3>ë¸Œë£¨ë“œ ì•„ë©”ë¦¬ì¹´ë…¸</h3>
                <p>â‚©4,000</p>
                <button class="btn" onclick="openAddToCartModal('ë¸Œë£¨ë“œ ì•„ë©”ë¦¬ì¹´ë…¸', 4000)">ì¥ë°”êµ¬ë‹ˆì— ì¶”ê°€</button>
            </div>
            <div class="menu-card">
                <img src="./02_CSS/img/bg_tree.png" alt="í•¸ë“œë“œë¦½ ì½œë“œë¸Œë£¨">
                <h3>í•¸ë“œë“œë¦½ ì½œë“œë¸Œë£¨</h3>
                <p>â‚©4,500</p>
                <button class="btn" onclick="openAddToCartModal('í•¸ë“œë“œë¦½ ì½œë“œë¸Œë£¨', 4500)">ì¥ë°”êµ¬ë‹ˆì— ì¶”ê°€</button>
            </div>
            <div class="menu-card">
                <img src="./02_CSS/img/bg_tree.png" alt="ì‹œê·¸ë‹ˆì²˜ ë¼ë–¼">
                <h3>ì‹œê·¸ë‹ˆì²˜ ë¼ë–¼</h3>
                <p>â‚©5,000</p>
                <button class="btn" onclick="openAddToCartModal('ì‹œê·¸ë‹ˆì²˜ ë¼ë–¼', 5000)">ì¥ë°”êµ¬ë‹ˆì— ì¶”ê°€</button>
            </div>
            <div class="menu-card">
                <img src="./02_CSS/img/bg_tree.png" alt="ë°€í¬ ë¼ë–¼">
                <h3>ë°€í¬ ë¼ë–¼</h3>
                <p>â‚©6,000</p>
                <button class="btn" onclick="openAddToCartModal('ë°€í¬ ë¼ë–¼', 6000)">ì¥ë°”êµ¬ë‹ˆì— ì¶”ê°€</button>
            </div>
        </div>
        <h2 class="section-title">ì‹œì¦Œ ê¸°ë… í•œì • ë©”ë‰´</h2>
        <div class="menu-grid2">
            <div class="menu-card2">
                <img src="./02_CSS/img/bg_tree.png" alt="ë¸Œë£¨ë“œ ì•„ë©”ë¦¬ì¹´ë…¸">
                <h3>ë¸Œë£¨ë“œ ì•„ë©”ë¦¬ì¹´ë…¸</h3>
                <p>â‚©4,000</p>
                <button class="btn" onclick="openAddToCartModal('ë¸Œë£¨ë“œ ì•„ë©”ë¦¬ì¹´ë…¸', 4000)">ì¥ë°”êµ¬ë‹ˆì— ì¶”ê°€</button>
            </div>
            <div class="menu-card2">
                <img src="./02_CSS/img/bg_tree.png" alt="í•¸ë“œë“œë¦½ ì½œë“œë¸Œë£¨">
                <h3>í•¸ë“œë“œë¦½ ì½œë“œë¸Œë£¨</h3>
                <p>â‚©4,500</p>
                <button class="btn" onclick="openAddToCartModal('í•¸ë“œë“œë¦½ ì½œë“œë¸Œë£¨', 4500)">ì¥ë°”êµ¬ë‹ˆì— ì¶”ê°€</button>
            </div>
            <div class="menu-card2">
                <img src="./02_CSS/img/bg_tree.png" alt="ì‹œê·¸ë‹ˆì²˜ ë¼ë–¼">
                <h3>ì‹œê·¸ë‹ˆì²˜ ë¼ë–¼</h3>
                <p>â‚©5,000</p>
                <button class="btn" onclick="openAddToCartModal('ì‹œê·¸ë‹ˆì²˜ ë¼ë–¼', 5000)">ì¥ë°”êµ¬ë‹ˆì— ì¶”ê°€</button>
            </div>
            <div class="menu-card2">
                <img src="./02_CSS/img/bg_tree.png" alt="ì—ìŠ¤í”„ë ˆì˜">
                <h3>ì—ìŠ¤í”„ë ˆì˜</h3>
                <p>â‚©6,000</p>
                <button class="btn" onclick="openAddToCartModal('ì—ìŠ¤í”„ë ˆì˜', 6000)">ì¥ë°”êµ¬ë‹ˆì— ì¶”ê°€</button>
            </div>
        </div>
    </div>

    <!-- ì£¼ë¬¸ ì¶”ê°€ ëª¨ë‹¬ -->
    <div class="modal" id="add-to-cart-modal">
        <div class="modal-content">
            <h3 id="modal-item-name"></h3>
            <p>ê°€ê²©: â‚©<span id="modal-item-price"></span></p>
            <div class="form-group options-group">
                <div>
                    <label>ì˜¨ë„</label>
                    <input type="radio" name="temp" value="hot" checked> í•«
                    <input type="radio" name="temp" value="ice"> ì•„ì´ìŠ¤
                </div>
                <div>
                    <label>ìƒ· ì¶”ê°€ (â‚©500)</label>
                    <input type="checkbox" id="extra-shot">
                </div>
                <div>
                    <label>ì‹œëŸ½ ì¶”ê°€ (â‚©500)</label>
                    <select id="syrup">
                        <option value="none">ì—†ìŒ</option>
                        <option value="vanilla">ë°”ë‹ë¼</option>
                        <option value="caramel">ìºëŸ¬ë©œ</option>
                    </select>
                </div>
                <div>
                    <label for="quantity">ìˆ˜ëŸ‰</label>
                    <input type="number" id="quantity" min="1" value="1">
                </div>
            </div>
            <div class="btn-group">
                <button class="btn" onclick="addToCart()">ì¥ë°”êµ¬ë‹ˆì— ì¶”ê°€</button>
                <button class="btn" onclick="closeAddToCartModal()">ë‹«ê¸°</button>
            </div>
        </div>
    </div>

    <!-- ì¥ë°”êµ¬ë‹ˆ ëª¨ë‹¬ -->
    <div class="modal" id="cart-modal">
        <div class="modal-content">
            <h3>ì¥ë°”êµ¬ë‹ˆ</h3>
            <div id="cart-items"></div>
            <div class="total-section">
                ì´ì•¡: â‚©<span id="cart-total">0</span> (ë°°ì†¡ë¹„: â‚©<span id="cart-shipping">0</span>)
            </div>
            <div class="form-group inline-group">
                <div>
                    <label for="cart-name">ì´ë¦„</label>
                    <input type="text" id="cart-name" placeholder="ì´ë¦„">
                    <span class="error" id="cart-name-error">ì´ë¦„ì„ 2ì ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”.</span>
                </div>
                <div>
                    <label for="cart-phone">ì—°ë½ì²˜</label>
                    <input type="text" id="cart-phone" placeholder="010-1234-5678">
                    <span class="error" id="cart-phone-error">ìœ íš¨í•œ ì—°ë½ì²˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</span>
                </div>
            </div>
            <div class="form-group">
                <label for="cart-address">ë°°ì†¡ì§€ ì£¼ì†Œ</label>
                <input type="text" id="cart-address" placeholder="ì£¼ì†Œ">
                <span class="error" id="cart-address-error">ì£¼ì†Œë¥¼ 5ì ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”.</span>
            </div>
            <div class="form-group">
                <label for="cart-payment">ê²°ì œ ìˆ˜ë‹¨</label>
                <select id="cart-payment">
                    <option value="card">ì‹ ìš©ì¹´ë“œ</option>
                    <option value="mobile">ê°„í¸ê²°ì œ</option>
                </select>
            </div>
            <div class="btn-group">
                <button class="btn" onclick="submitOrder()">ê²°ì œí•˜ê¸°</button>
                <button class="btn" onclick="closeCartModal()">ë‹«ê¸°</button>
            </div>
        </div>
    </div>

    <footer>
        Â© 2025 ìˆ˜ì œì»¤í”¼ë¸Œë£¨ | ê²½ê¸°ë„ ì»¤í”¼ì‹œ í–¥ê¸°êµ¬ ì•„ë¼ë¹„ì¹´ë¡œ 100
    </footer>

    <script>
        let currentItem = null;
        let cart = JSON.parse(localStorage.getItem('cart')) || [];

        function openAddToCartModal(name, basePrice) {
            currentItem = { name, basePrice };
            document.getElementById('modal-item-name').textContent = name;
            document.getElementById('modal-item-price').textContent = basePrice;
            document.getElementById('quantity').value = 1;
            document.getElementById('extra-shot').checked = false;
            document.getElementById('syrup').value = 'none';
            document.querySelector('input[name="temp"][value="hot"]').checked = true;
            document.getElementById('add-to-cart-modal').style.display = 'flex';
        }

        function closeAddToCartModal() {
            document.getElementById('add-to-cart-modal').style.display = 'none';
            currentItem = null;
        }

        function addToCart() {
            const item = {
                itemId: 'ITEM' + Date.now(),
                name: currentItem.name,
                basePrice: currentItem.basePrice,
                temp: document.querySelector('input[name="temp"]:checked').value,
                extraShot: document.getElementById('extra-shot').checked,
                syrup: document.getElementById('syrup').value,
                quantity: parseInt(document.getElementById('quantity').value) || 1
            };
            cart.push(item);
            localStorage.setItem('cart', JSON.stringify(cart));
            alert(`${item.name}ì´(ê°€) ì¥ë°”êµ¬ë‹ˆì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`);
            closeAddToCartModal();
            openCartModal();
        }

        function openCartModal() {
            displayCartItems();
            document.getElementById('cart-modal').style.display = 'flex';
        }

        function closeCartModal() {
            document.getElementById('cart-modal').style.display = 'none';
            document.querySelectorAll('.error').forEach(e => e.style.display = 'none');
        }

        function displayCartItems() {
            const cartItems = document.getElementById('cart-items');
            cartItems.innerHTML = '';
            let subtotal = 0;
            cart.forEach(item => {
                let price = item.basePrice;
                if (item.extraShot) price += 500;
                if (item.syrup !== 'none') price += 500;
                const itemTotal = price * item.quantity;
                subtotal += itemTotal;

                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <div class="cart-item-details">
                        <strong>${item.name}</strong><br>
                        ì˜¨ë„: ${item.temp}, ìƒ· ì¶”ê°€: ${item.extraShot ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤'}, 
                        ì‹œëŸ½: ${item.syrup === 'none' ? 'ì—†ìŒ' : item.syrup}<br>
                        ìˆ˜ëŸ‰: <input type="number" min="1" value="${item.quantity}" onchange="updateCartItemQuantity('${item.itemId}', this.value)">
                        ê°€ê²©: â‚©${itemTotal}
                    </div>
                    <div class="cart-item-actions">
                        <button class="btn" onclick="removeCartItem('${item.itemId}')">ì‚­ì œ</button>
                    </div>
                `;
                cartItems.appendChild(cartItem);
            });

            const shipping = subtotal >= 30000 ? 0 : 3000;
            document.getElementById('cart-total').textContent = subtotal + shipping;
            document.getElementById('cart-shipping').textContent = shipping;
        }

        function updateCartItemQuantity(itemId, quantity) {
            const item = cart.find(i => i.itemId === itemId);
            if (item) {
                item.quantity = parseInt(quantity) || 1;
                localStorage.setItem('cart', JSON.stringify(cart));
                displayCartItems();
            }
        }

        function removeCartItem(itemId) {
            cart = cart.filter(i => i.itemId !== itemId);
            localStorage.setItem('cart', JSON.stringify(cart));
            displayCartItems();
        }

        function validateOrderForm() {
            const name = document.getElementById('cart-name').value.trim();
            const address = document.getElementById('cart-address').value.trim();
            const phone = document.getElementById('cart-phone').value.trim();
            let isValid = true;

            document.querySelectorAll('.error').forEach(e => e.style.display = 'none');

            if (cart.length === 0) {
                alert('ì¥ë°”êµ¬ë‹ˆê°€ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.');
                return false;
            }
            if (name.length < 2) {
                document.getElementById('cart-name-error').style.display = 'block';
                isValid = false;
            }
            if (address.length < 5) {
                document.getElementById('cart-address-error').style.display = 'block';
                isValid = false;
            }
            if (!/^\d{3}-\d{4}-\d{4}$/.test(phone)) {
                document.getElementById('cart-phone-error').style.display = 'block';
                isValid = false;
            }
            return isValid;
        }

        async function submitOrder() {
            if (!validateOrderForm()) return;

            const items = cart.map(item => ({
                name: item.name,
                price: item.basePrice + (item.extraShot ? 500 : 0) + (item.syrup !== 'none' ? 500 : 0),
                quantity: item.quantity,
                temp: item.temp,
                extraShot: item.extraShot,
                syrup: item.syrup
            }));
            const subtotal = items.reduce((sum, item) => sum + item.price * item.quantity, 0);
            const shipping = subtotal >= 30000 ? 0 : 3000;
            const order = {
                items,
                name: document.getElementById('cart-name').value.trim(),
                address: document.getElementById('cart-address').value.trim(),
                phone: document.getElementById('cart-phone').value.trim(),
                payment: document.getElementById('cart-payment').value,
                subtotal,
                shipping,
                total: subtotal + shipping,
                orderId: 'ORD' + Date.now(),
                status: 'ì£¼ë¬¸ ì ‘ìˆ˜',
                createdAt: new Date().toISOString()
            };

            // Toss Payments API í˜¸ì¶œ (ëª¨ì˜)
            try {
                // ì‹¤ì œ API í˜¸ì¶œ ì˜ˆì‹œ (í‚¤ í•„ìš”)
                /*
                const response = await fetch('https://api.tosspayments.com/v1/payments', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Basic YOUR_TOSS_API_KEY',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        amount: order.total,
                        orderId: order.orderId,
                        orderName: 'ìˆ˜ì œì»¤í”¼ë¸Œë£¨ ì£¼ë¬¸',
                        customerName: order.name
                    })
                });
                const result = await response.json();
                if (!result.success) throw new Error('ê²°ì œ ì‹¤íŒ¨');
                */

                // ëª¨ì˜ ê²°ì œ
                console.log('Toss Payments API í˜¸ì¶œ ì‹œë®¬ë ˆì´ì…˜:', {
                    amount: order.total,
                    orderId: order.orderId,
                    orderName: 'ìˆ˜ì œì»¤í”¼ë¸Œë£¨ ì£¼ë¬¸',
                    customerName: order.name
                });

                // ì£¼ë¬¸ ì €ì¥
                const orders = JSON.parse(localStorage.getItem('orders')) || [];
                orders.push(order);
                localStorage.setItem('orders', JSON.stringify(orders));

                // ì¥ë°”êµ¬ë‹ˆ ì´ˆê¸°í™”
                cart = [];
                localStorage.setItem('cart', JSON.stringify(cart));

                alert(`ê²°ì œ ì™„ë£Œ! ì£¼ë¬¸ ë²ˆí˜¸: ${order.orderId}\nì´ì•¡: â‚©${order.total}`);
                closeCartModal();
                window.location.href = './07_teamproj_order_page.html';
            } catch (error) {
                console.error('ê²°ì œ ì˜¤ë¥˜:', error);
                alert('ê²°ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
            }
        }

        document.getElementById('quantity').addEventListener('input', () => {
            document.getElementById('quantity').value = Math.max(1, parseInt(document.getElementById('quantity').value) || 1);
        });
        document.getElementById('extra-shot').addEventListener('change', () => {});
        document.getElementById('syrup').addEventListener('change', () => {});
        document.querySelectorAll('input[name="temp"]').forEach(radio => radio.addEventListener('change', () => {}));

        document.getElementById('cart-phone').addEventListener('keydown', (e) => {
            if (e.key === 'Enter') submitOrder();
        });
    </script>
</body>
</html>